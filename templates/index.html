<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>FamilyMart OCR Parser</title>
    <style>
        body { font-family: sans-serif; max-width: 700px; margin: 40px auto; background: #f0f2f5; line-height: 1.6; }
        .card { background: white; padding: 25px; border-radius: 10px; shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { color: #006b3d; text-align: center; border-bottom: 2px solid #006b3d; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #f8f9fa; }
        .total { font-weight: bold; background: #e8f5e9; }
        .btn { display: inline-block; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; border: none; cursor: pointer; margin-top: 10px; }
        .btn-download { background: #28a745; }
        .log-btn { background: #6c757d; }
        pre { background: #eee; padding: 10px; font-size: 12px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="card">
        <h1>ğŸ§¾ ãƒ¬ã‚·ãƒ¼ãƒˆè§£æã‚·ã‚¹ãƒ†ãƒ </h1>
        <form method="post" enctype="multipart/form-data" style="text-align:center;">
            <input type="file" name="file" accept="image/*" required>
            <button type="submit" class="btn">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰è§£æ</button>
        </form>

        {% if data %}
        <h3>æŠ½å‡ºçµæœ</h3>
        <table>
            <thead><tr><th>å•†å“å</th><th>ä¾¡æ ¼</th></tr></thead>
            <tbody>
                {% for item in data.receipt_list %}
                <tr><td>{{ item.name }}</td><td>Â¥{{ item.price }}</td></tr>
                {% endfor %}
                <tr class="total"><td>åˆè¨ˆ</td><td>Â¥{{ data.total }}</td></tr>
            </tbody>
        </table>

        <div style="display:flex; gap:10px;">
            <form action="/download_csv" method="post">
                <input type="hidden" name="csv_content" value="{{ data.csv_data }}">
                <button type="submit" class="btn btn-download">CSVã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
            </form>
            <form action="/download_log" method="post">
                <input type="hidden" name="log_content" value="{{ data.log_data }}">
                <button type="submit" class="btn log-btn">ocr.logã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
            </form>
        </div>

        <details style="margin-top:20px;">
            <summary>OCR ç”Ÿãƒ†ã‚­ã‚¹ãƒˆ (ocr.log å†…å®¹)</summary>
            <pre>{{ data.raw_text }}</pre>
        </details>
        {% endif %}
    </div>
</body>
</html>
